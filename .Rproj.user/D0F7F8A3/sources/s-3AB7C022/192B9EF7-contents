#'@name team_11
#'@title team_11's function for 2-level list extraction
#'@author Lab 2 team 11 from STAT 585 Spring 2019
#'@seealso purrr::map_depth, purrr::map_dfr
#'@return a small shape file
#'@description This function extracts data from a shapefile with 2 levels in file$geometry
#'@export
#'@importFrom sf read_sf st_as_sf
#'@importFrom maptools thinnedSpatialPoly
#'@importFrom purrr map_depth flatten map_dfr

team_11 <- function(file, tolerance = 0.1) {

  shpbig <- read_sf(file)
  shp_st <- thinnedSpatialPoly(
    as(shpbig, "Spatial"), tolerance = tolerance,
    minarea = 0.001, topologyPreserve = TRUE)
  shp <- st_as_sf(shp_st)

  map_depth(.x = shp$geometry, 2, .f = c(1)) %>% flatten %>%
    map_dfr(data.frame, .id = "group") -> df
  colnames(df) <- c("group", "long", "lat")
  df$order <- seq(from = 1, to = nrow(df), by = 1)
  return(df)
}
